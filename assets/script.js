!function(e){var t={};function o(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,o),l.l=!0,l.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)o.d(n,l,function(t){return e[t]}.bind(null,l));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,o){},function(e,t,o){o(2),e.exports=o(0)},function(e,t,o){"use strict";o.r(t);o(0),o(3),o(4),o(5),o(6);const n={x:0,y:0,tool:"pencil"},l={size:128},c={currentColor:"#FFC107",prevColor:"#FFEB3B",red:"#F74141",blue:"#00BCD4"};document.getElementById("current").style.backgroundColor=`${c.currentColor}`,document.getElementById("previous").style.backgroundColor=`${c.prevColor}`,document.getElementById("red").style.backgroundColor=`${c.red}`,document.getElementById("blue").style.backgroundColor=`${c.blue}`;const a=document.getElementById("palette"),r=a.getContext("2d");function u(e){r.imageSmoothingEnabled=!1,r.webkitImageSmoothingEnabled=!1;const t=e,o=localStorage.getItem("canvas"),n=new Image;n.src=o,n.onload=function(){a.width=t,a.height=t,r.drawImage(n,0,0,t,t),localStorage.setItem("canvas",document.getElementById("palette").toDataURL())}}function d(){return a.onmousemove=null,localStorage.setItem("canvas",document.getElementById("palette").toDataURL()),localStorage.setItem("width",r.canvas.width),null}function i(e){const t=document.getElementById("current");c.prevColor=c.currentColor;const o=document.getElementById("previous");return c.currentColor=e,t.style.background=e,o.style.background=c.prevColor,c.currentColor}r.canvas.width=128,r.canvas.height=128,r.fillStyle="white",r.fillRect(0,0,512,512),document.querySelector(".tools__list").addEventListener("click",e=>{n.tool=e.target.id;const t=e.target;document.body.style.cursor=`url('./src/blocks/main/${n.tool}.svg'), auto`,null!==document.querySelector(".active")&&(document.querySelector(".active").className="list__item"),t.parentNode.className="list__item active"}),a.onmousedown=function(e){if(r.fillStyle=c.currentColor,"pencil"===n.tool){let t=e.offsetX,o=e.offsetY;a.onmousemove=function(e){const n=e.offsetX,l=e.offsetY;!function(){const e=Math.abs(n-t),c=Math.abs(l-o),a=t<n?1:-1,u=o<l?1:-1;let d=e-c;for(;t;){const i=Math.floor(t*r.canvas.width/512),s=Math.floor(o*r.canvas.height/512);if(r.fillRect(i,s,1,1),r.fill(),t===n&&o===l)break;const m=2*d;m>-c&&(d-=c,t+=+a),m<e&&(d+=e,o+=+u)}}()},a.onmouseup=d}"bucket"===n.tool&&(r.fillStyle=`${c.currentColor}`,r.fillRect(0,0,r.canvas.width,r.canvas.height),localStorage.setItem("canvas",document.getElementById("palette").toDataURL()),localStorage.setItem("width",r.canvas.width))},document.getElementById("curColor").oninput=()=>{i(document.getElementById("curColor").value)},document.getElementById("current").addEventListener("click",()=>{i(document.getElementById("current").style.backgroundColor)}),document.getElementById("previous").addEventListener("click",()=>{i(document.getElementById("previous").style.backgroundColor)}),document.getElementById("red").addEventListener("click",()=>{i(document.getElementById("red").style.backgroundColor)}),document.getElementById("blue").addEventListener("click",()=>{i(document.getElementById("blue").style.backgroundColor)}),document.addEventListener("keydown",e=>{switch(e.code){case"KeyC":document.getElementById("curColor").click();break;case"KeyV":n.tool="pencil",document.getElementById("pencil").click();break;case"KeyB":n.tool="bucket",document.getElementById("bucket").click()}}),document.getElementById("load").addEventListener("click",async()=>{const e=new Image;e.crossOrigin="anonymous";const t=`https://api.unsplash.com/photos/random?query=town,${document.getElementById("search").value}&client_id=9a97d3fa2e93eeb1f8c028963896a447f1b5c7316248e00ef490d65df1d10d2e`;await fetch(t).then(e=>e.json()).then(t=>{e.src=t.urls.small,localStorage.setItem("image",e.src),e.onload=function(){if(e.width>=e.height){r.canvas.width=l.size;const t=l.size*(e.height/e.width),o=(l.size-t)/2;r.drawImage(e,0,o,r.canvas.width,t),localStorage.setItem("canvas",document.getElementById("palette").toDataURL()),localStorage.setItem("width",r.canvas.width)}else{r.canvas.height=l.size;const t=l.size*(e.width/e.height),o=(l.size-t)/2;r.drawImage(e,o,0,t,r.canvas.height),localStorage.setItem("canvas",document.getElementById("palette").toDataURL()),localStorage.setItem("width",r.canvas.width)}}})});const s=document.querySelector(".input-range__number"),m=document.querySelector(".input-range__value");if(document.getElementById("value").innerText=`${l.size}`,s.oninput=function(){switch(`${this.value}`){case"1":document.getElementById("value").innerText="4",m.style.left="-15px",l.size=4,u(4);break;case"2":document.getElementById("value").innerText=" 32",m.style.left="150px",l.size=32,u(32);break;case"3":document.getElementById("value").innerText="128",m.style.left="315px",l.size=128,u(128);break;case"4":document.getElementById("value").innerText="256",m.style.left="480px",l.size=256,u(256)}},document.getElementById("grayscale").addEventListener("click",()=>{const e=localStorage.getItem("width"),t=r.getImageData(0,0,e,e),o=r.createImageData(e,e),n=t.data,l=o.data;let c;for(let e=0;e<n.length;e+=4)c=.2126*n[e]+.7152*n[e+1]+.0722*n[e+2],l[e]=c,l[e+1]=c,l[e+2]=c,l[e+3]=n[e+3];r.putImageData(o,0,0),localStorage.setItem("canvas",document.getElementById("palette").toDataURL())}),null!==localStorage.getItem("mouse")&&window.confirm("Восстановить данные предыдущей сессии?")){const e=localStorage.getItem("width"),t=localStorage.getItem("canvas"),o=new Image;o.src=t,o.onload=function(){a.width=e,a.height=e,r.drawImage(o,0,0)},n.tool=localStorage.getItem("mouse"),i(localStorage.getItem("previousColor")),i(localStorage.getItem("currentColor")),document.body.style.cursor=`url('./src/blocks/main/${n.tool}.svg'), auto`,document.getElementById(n.tool).parentNode.className="list__item active",document.querySelector(".main__canvas").style.imageRendering="pixelated"}window.onunload=function(){localStorage.setItem("mouse",n.tool),localStorage.setItem("currentColor",document.getElementById("current").style.backgroundColor),localStorage.setItem("previousColor",document.getElementById("previous").style.backgroundColor),localStorage.setItem("input-range",l.size)},document.getElementById(`${n.tool}`).click();const g=document.querySelector(".menu__button");g.href="https://github.com/login/oauth/authorize?client_id=d0fe394c463d8e5e0973&redirect_uri=https://agentra.github.io/image-api/",g.addEventListener("click",()=>{window.location.href=g.href})},function(e,t,o){},function(e,t,o){},function(e,t,o){},function(e,t,o){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwibW91c2UiLCJ4IiwieSIsInRvb2wiLCJpbnB1dCIsInNpemUiLCJjb2xvcnMiLCJjdXJyZW50Q29sb3IiLCJwcmV2Q29sb3IiLCJyZWQiLCJibHVlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiY2FudmFzIiwiY3R4IiwiZ2V0Q29udGV4dCIsImRyYXdGcm9tU3RvcmFnZSIsIndpZHRoIiwiaW1hZ2VTbW9vdGhpbmdFbmFibGVkIiwid2Via2l0SW1hZ2VTbW9vdGhpbmdFbmFibGVkIiwiZGF0YVVSTCIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJpbWdEYXRhIiwiSW1hZ2UiLCJzcmMiLCJvbmxvYWQiLCJoZWlnaHQiLCJkcmF3SW1hZ2UiLCJzZXRJdGVtIiwidG9EYXRhVVJMIiwibW91c2VVcCIsIm9ubW91c2Vtb3ZlIiwiY2hhbmdlQ29sb3IiLCJjb2xvciIsImN1cnIiLCJwcmV2IiwiYmFja2dyb3VuZCIsImZpbGxTdHlsZSIsImZpbGxSZWN0IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInRhcmdldCIsImlkIiwiZWxlbSIsImJvZHkiLCJjdXJzb3IiLCJjbGFzc05hbWUiLCJwYXJlbnROb2RlIiwib25tb3VzZWRvd24iLCJ4MCIsIm9mZnNldFgiLCJ5MCIsIm9mZnNldFkiLCJuZXdFdmVudCIsIngxIiwieTEiLCJkeCIsIk1hdGgiLCJhYnMiLCJkeSIsInN4Iiwic3kiLCJlcnIiLCJmaWxsWCIsImZsb29yIiwiZmlsbFkiLCJmaWxsIiwiZTIiLCJsaW5lIiwib25tb3VzZXVwIiwib25pbnB1dCIsImNvZGUiLCJjbGljayIsImFzeW5jIiwiaW1nIiwiY3Jvc3NPcmlnaW4iLCJ1cmwiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJqc29uIiwiZGF0YSIsInVybHMiLCJzbWFsbCIsInN0YXJ0WSIsInN0YXJ0WCIsInJhbmdlIiwiaW5uZXJUZXh0IiwidGhpcyIsImxlZnQiLCJpbWFnZURhdGEiLCJnZXRJbWFnZURhdGEiLCJibGFja0ltYWdlIiwiY3JlYXRlSW1hZ2VEYXRhIiwic291cmNlRGF0YSIsImJsYWNrRGF0YSIsImx1bWEiLCJsZW5ndGgiLCJwdXRJbWFnZURhdGEiLCJ3aW5kb3ciLCJjb25maXJtIiwiaW1hZ2VSZW5kZXJpbmciLCJvbnVubG9hZCIsImxvZ2luIiwiaHJlZiIsImxvY2F0aW9uIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVB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USIsImZpbGUiOiJzY3JpcHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJpbXBvcnQgJy4vc3R5bGUuc2Nzcyc7XG5pbXBvcnQgJy4vYmxvY2tzL2hlYWRlci9oZWFkZXIuc2Nzcyc7XG5pbXBvcnQgJy4vdHlwb2dyYXBoeS9mb250cy5zY3NzJztcbmltcG9ydCAnLi9ibG9ja3MvbWFpbi9tYWluLnNjc3MnO1xuaW1wb3J0ICcuL21peGluLnNjc3MnO1xuXG5jb25zdCBtb3VzZSA9IHtcbiAgeDogMCxcbiAgeTogMCxcbiAgdG9vbDogJ3BlbmNpbCcsXG59O1xuXG5jb25zdCBpbnB1dCA9IHtcbiAgc2l6ZTogMTI4LFxufTtcblxuXG5jb25zdCBjb2xvcnMgPSB7XG4gIGN1cnJlbnRDb2xvcjogJyNGRkMxMDcnLFxuICBwcmV2Q29sb3I6ICcjRkZFQjNCJyxcbiAgcmVkOiAnI0Y3NDE0MScsXG4gIGJsdWU6ICcjMDBCQ0Q0Jyxcbn07XG5cbi8vIGNvbnN0IGtleSA9ICcxYWVkNTEzNGQ1OTNiY2JiMzYwNmViZDljYTE1M2FkYjZiNTJhYWQ3NDY3MjNiZGMzZDRmMjNmYTNlNjNiOWI4JztcbmNvbnN0IGtleSA9ICc5YTk3ZDNmYTJlOTNlZWIxZjhjMDI4OTYzODk2YTQ0N2YxYjVjNzMxNjI0OGUwMGVmNDkwZDY1ZGYxZDEwZDJlJztcblxuLy8gZDBmZTM5NGM0NjNkOGU1ZTA5NzMgLy8gY2xpZW50IElEIGZvciBHaXRcbi8vIDMzNjI3ZGY4ZTFiNjdiOTFmYmExMDY0OTE3NGQyMzUyYmQ0MDI3ODQgLy8gY2xpZW50IFNlY3JldCBmb3IgR2l0XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudCcpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGAke2NvbG9ycy5jdXJyZW50Q29sb3J9YDtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aW91cycpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGAke2NvbG9ycy5wcmV2Q29sb3J9YDtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZWQnKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBgJHtjb2xvcnMucmVkfWA7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmx1ZScpLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGAke2NvbG9ycy5ibHVlfWA7XG5cbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWxldHRlJyk7XG5jb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbmN0eC5jYW52YXMud2lkdGggPSAxMjg7XG5jdHguY2FudmFzLmhlaWdodCA9IDEyODtcbmN0eC5maWxsU3R5bGUgPSAnd2hpdGUnO1xuY3R4LmZpbGxSZWN0KDAsIDAsIDUxMiwgNTEyKTtcblxuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudG9vbHNfX2xpc3QnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldmVudCkgPT4ge1xuICBtb3VzZS50b29sID0gZXZlbnQudGFyZ2V0LmlkO1xuICBjb25zdCBlbGVtID0gZXZlbnQudGFyZ2V0O1xuICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9IGB1cmwoJy4vc3JjL2Jsb2Nrcy9tYWluLyR7bW91c2UudG9vbH0uc3ZnJyksIGF1dG9gO1xuICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZScpICE9PSBudWxsKSB7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFjdGl2ZScpLmNsYXNzTmFtZSA9ICdsaXN0X19pdGVtJztcbiAgfVxuICBlbGVtLnBhcmVudE5vZGUuY2xhc3NOYW1lID0gJ2xpc3RfX2l0ZW0gYWN0aXZlJztcbn0pO1xuXG5mdW5jdGlvbiBkcmF3RnJvbVN0b3JhZ2Uod2lkdGgpIHtcbiAgY3R4LmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xuICBjdHgud2Via2l0SW1hZ2VTbW9vdGhpbmdFbmFibGVkID0gZmFsc2U7XG4gIGNvbnN0IHNpemUgPSB3aWR0aDtcbiAgY29uc3QgZGF0YVVSTCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjYW52YXMnKTtcbiAgY29uc3QgaW1nRGF0YSA9IG5ldyBJbWFnZSgpO1xuICBpbWdEYXRhLnNyYyA9IGRhdGFVUkw7XG4gIGltZ0RhdGEub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgIGNhbnZhcy53aWR0aCA9IHNpemU7XG4gICAgY2FudmFzLmhlaWdodCA9IHNpemU7XG4gICAgY3R4LmRyYXdJbWFnZShpbWdEYXRhLCAwLCAwLCBzaXplLCBzaXplKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FudmFzJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhbGV0dGUnKS50b0RhdGFVUkwoKSk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIG1vdXNlVXAoKSB7XG4gIGNhbnZhcy5vbm1vdXNlbW92ZSA9IG51bGw7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYW52YXMnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFsZXR0ZScpLnRvRGF0YVVSTCgpKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3dpZHRoJywgY3R4LmNhbnZhcy53aWR0aCk7XG4gIHJldHVybiBudWxsO1xufVxuXG5jYW52YXMub25tb3VzZWRvd24gPSBmdW5jdGlvbiB0b29sRHJhdyhldmVudCkge1xuICBjdHguZmlsbFN0eWxlID0gY29sb3JzLmN1cnJlbnRDb2xvcjtcbiAgaWYgKG1vdXNlLnRvb2wgPT09ICdwZW5jaWwnKSB7XG4gICAgbGV0IHgwID0gZXZlbnQub2Zmc2V0WDtcbiAgICBsZXQgeTAgPSBldmVudC5vZmZzZXRZO1xuXG4gICAgY2FudmFzLm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gYnJleihuZXdFdmVudCkge1xuICAgICAgY29uc3QgeDEgPSBuZXdFdmVudC5vZmZzZXRYO1xuICAgICAgY29uc3QgeTEgPSBuZXdFdmVudC5vZmZzZXRZO1xuICAgICAgZnVuY3Rpb24gbGluZSgpIHtcbiAgICAgICAgY29uc3QgZHggPSBNYXRoLmFicyh4MSAtIHgwKTtcbiAgICAgICAgY29uc3QgZHkgPSBNYXRoLmFicyh5MSAtIHkwKTtcbiAgICAgICAgY29uc3Qgc3ggPSAoeDAgPCB4MSkgPyAxIDogLTE7XG4gICAgICAgIGNvbnN0IHN5ID0gKHkwIDwgeTEpID8gMSA6IC0xO1xuICAgICAgICBsZXQgZXJyID0gZHggLSBkeTtcblxuICAgICAgICB3aGlsZSAoeDApIHtcbiAgICAgICAgICBjb25zdCBmaWxsWCA9IE1hdGguZmxvb3IoKHgwICogY3R4LmNhbnZhcy53aWR0aCkgLyA1MTIpO1xuICAgICAgICAgIGNvbnN0IGZpbGxZID0gTWF0aC5mbG9vcigoeTAgKiBjdHguY2FudmFzLmhlaWdodCkgLyA1MTIpO1xuICAgICAgICAgIGN0eC5maWxsUmVjdChmaWxsWCwgZmlsbFksIDEsIDEpO1xuICAgICAgICAgIGN0eC5maWxsKCk7XG5cbiAgICAgICAgICBpZiAoKHgwID09PSB4MSkgJiYgKHkwID09PSB5MSkpIGJyZWFrO1xuICAgICAgICAgIGNvbnN0IGUyID0gMiAqIGVycjtcbiAgICAgICAgICBpZiAoZTIgPiAtZHkpIHsgZXJyIC09IGR5OyB4MCArPSArc3g7IH1cbiAgICAgICAgICBpZiAoZTIgPCBkeCkgeyBlcnIgKz0gZHg7IHkwICs9ICtzeTsgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsaW5lKCk7XG4gICAgfTtcblxuICAgIGNhbnZhcy5vbm1vdXNldXAgPSBtb3VzZVVwO1xuICB9XG4gIGlmIChtb3VzZS50b29sID09PSAnYnVja2V0Jykge1xuICAgIGN0eC5maWxsU3R5bGUgPSBgJHtjb2xvcnMuY3VycmVudENvbG9yfWA7XG4gICAgY3R4LmZpbGxSZWN0KDAsIDAsIGN0eC5jYW52YXMud2lkdGgsIGN0eC5jYW52YXMuaGVpZ2h0KTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY2FudmFzJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhbGV0dGUnKS50b0RhdGFVUkwoKSk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3dpZHRoJywgY3R4LmNhbnZhcy53aWR0aCk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGNoYW5nZUNvbG9yKGNvbG9yKSB7XG4gIGNvbnN0IGN1cnIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudCcpO1xuICBjb2xvcnMucHJldkNvbG9yID0gY29sb3JzLmN1cnJlbnRDb2xvcjtcbiAgY29uc3QgcHJldiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aW91cycpO1xuICBjb2xvcnMuY3VycmVudENvbG9yID0gY29sb3I7XG4gIGN1cnIuc3R5bGUuYmFja2dyb3VuZCA9IGNvbG9yO1xuICBwcmV2LnN0eWxlLmJhY2tncm91bmQgPSBjb2xvcnMucHJldkNvbG9yO1xuICByZXR1cm4gKGNvbG9ycy5jdXJyZW50Q29sb3IpO1xufVxuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VyQ29sb3InKS5vbmlucHV0ID0gKCkgPT4ge1xuICBjaGFuZ2VDb2xvcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VyQ29sb3InKS52YWx1ZSk7XG59O1xuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjaGFuZ2VDb2xvcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3VycmVudCcpLnN0eWxlLmJhY2tncm91bmRDb2xvcik7XG59KTtcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ByZXZpb3VzJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGNoYW5nZUNvbG9yKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aW91cycpLnN0eWxlLmJhY2tncm91bmRDb2xvcik7XG59KTtcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlZCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjaGFuZ2VDb2xvcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVkJykuc3R5bGUuYmFja2dyb3VuZENvbG9yKTtcbn0pO1xuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmx1ZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICBjaGFuZ2VDb2xvcihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmx1ZScpLnN0eWxlLmJhY2tncm91bmRDb2xvcik7XG59KTtcblxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldmVudCkgPT4ge1xuICBzd2l0Y2ggKGV2ZW50LmNvZGUpIHtcbiAgICBjYXNlICdLZXlDJzpcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXJDb2xvcicpLmNsaWNrKCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdLZXlWJzpcbiAgICAgIG1vdXNlLnRvb2wgPSAncGVuY2lsJztcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW5jaWwnKS5jbGljaygpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnS2V5Qic6XG4gICAgICBtb3VzZS50b29sID0gJ2J1Y2tldCc7XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnVja2V0JykuY2xpY2soKTtcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICBicmVhaztcbiAgfVxufSk7XG5cbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2FkJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICBpbWcuY3Jvc3NPcmlnaW4gPSAnYW5vbnltb3VzJztcbiAgY29uc3QgdG93biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2gnKS52YWx1ZTtcbiAgY29uc3QgdXJsID0gYGh0dHBzOi8vYXBpLnVuc3BsYXNoLmNvbS9waG90b3MvcmFuZG9tP3F1ZXJ5PXRvd24sJHt0b3dufSZjbGllbnRfaWQ9JHtrZXl9YDtcbiAgYXdhaXQgZmV0Y2godXJsKVxuICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcbiAgICAgIGltZy5zcmMgPSBkYXRhLnVybHMuc21hbGw7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnaW1hZ2UnLCBpbWcuc3JjKTtcbiAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChpbWcud2lkdGggPj0gaW1nLmhlaWdodCkge1xuICAgICAgICAgIGN0eC5jYW52YXMud2lkdGggPSBpbnB1dC5zaXplO1xuICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGlucHV0LnNpemUgKiAoaW1nLmhlaWdodCAvIGltZy53aWR0aCk7XG4gICAgICAgICAgY29uc3Qgc3RhcnRZID0gKGlucHV0LnNpemUgLSBoZWlnaHQpIC8gMjtcbiAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgc3RhcnRZLCBjdHguY2FudmFzLndpZHRoLCBoZWlnaHQpO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYW52YXMnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFsZXR0ZScpLnRvRGF0YVVSTCgpKTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnd2lkdGgnLCBjdHguY2FudmFzLndpZHRoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjdHguY2FudmFzLmhlaWdodCA9IGlucHV0LnNpemU7XG4gICAgICAgICAgY29uc3Qgd2lkdGggPSBpbnB1dC5zaXplICogKGltZy53aWR0aCAvIGltZy5oZWlnaHQpO1xuICAgICAgICAgIGNvbnN0IHN0YXJ0WCA9IChpbnB1dC5zaXplIC0gd2lkdGgpIC8gMjtcbiAgICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgc3RhcnRYLCAwLCB3aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdjYW52YXMnLCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFsZXR0ZScpLnRvRGF0YVVSTCgpKTtcbiAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnd2lkdGgnLCBjdHguY2FudmFzLndpZHRoKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbn0pO1xuXG5jb25zdCByYW5nZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1yYW5nZV9fbnVtYmVyJyk7XG5jb25zdCB2YWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1yYW5nZV9fdmFsdWUnKTtcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YWx1ZScpLmlubmVyVGV4dCA9IGAke2lucHV0LnNpemV9YDtcblxucmFuZ2Uub25pbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgc3dpdGNoIChgJHt0aGlzLnZhbHVlfWApIHtcbiAgICBjYXNlICcxJzpcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YWx1ZScpLmlubmVyVGV4dCA9ICc0JztcbiAgICAgIHZhbHVlLnN0eWxlLmxlZnQgPSAnLTE1cHgnO1xuICAgICAgaW5wdXQuc2l6ZSA9IDQ7XG4gICAgICBkcmF3RnJvbVN0b3JhZ2UoNCk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICcyJzpcbiAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2YWx1ZScpLmlubmVyVGV4dCA9ICcgMzInO1xuICAgICAgdmFsdWUuc3R5bGUubGVmdCA9ICcxNTBweCc7XG4gICAgICBpbnB1dC5zaXplID0gMzI7XG4gICAgICBkcmF3RnJvbVN0b3JhZ2UoMzIpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnMyc6XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFsdWUnKS5pbm5lclRleHQgPSAnMTI4JztcbiAgICAgIHZhbHVlLnN0eWxlLmxlZnQgPSAnMzE1cHgnO1xuICAgICAgaW5wdXQuc2l6ZSA9IDEyODtcbiAgICAgIGRyYXdGcm9tU3RvcmFnZSgxMjgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnNCc6XG4gICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmFsdWUnKS5pbm5lclRleHQgPSAnMjU2JztcbiAgICAgIHZhbHVlLnN0eWxlLmxlZnQgPSAnNDgwcHgnO1xuICAgICAgaW5wdXQuc2l6ZSA9IDI1NjtcbiAgICAgIGRyYXdGcm9tU3RvcmFnZSgyNTYpO1xuICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgIGJyZWFrO1xuICB9XG59O1xuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ3JheXNjYWxlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGNvbnN0IHdpZHRoID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3dpZHRoJyk7XG4gIGNvbnN0IGltYWdlRGF0YSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgd2lkdGgsIHdpZHRoKTtcbiAgY29uc3QgYmxhY2tJbWFnZSA9IGN0eC5jcmVhdGVJbWFnZURhdGEod2lkdGgsIHdpZHRoKTtcbiAgY29uc3Qgc291cmNlRGF0YSA9IGltYWdlRGF0YS5kYXRhO1xuICBjb25zdCBibGFja0RhdGEgPSBibGFja0ltYWdlLmRhdGE7XG4gIGxldCBsdW1hO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHNvdXJjZURhdGEubGVuZ3RoOyBpICs9IDQpIHtcbiAgICBsdW1hID0gc291cmNlRGF0YVtpXSAqIDAuMjEyNiArIHNvdXJjZURhdGFbaSArIDFdICogMC43MTUyICsgc291cmNlRGF0YVtpICsgMl0gKiAwLjA3MjI7XG4gICAgYmxhY2tEYXRhW2ldID0gbHVtYTtcbiAgICBibGFja0RhdGFbaSArIDFdID0gbHVtYTtcbiAgICBibGFja0RhdGFbaSArIDJdID0gbHVtYTtcbiAgICBibGFja0RhdGFbaSArIDNdID0gc291cmNlRGF0YVtpICsgM107XG4gIH1cbiAgY3R4LnB1dEltYWdlRGF0YShibGFja0ltYWdlLCAwLCAwKTtcbiAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NhbnZhcycsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWxldHRlJykudG9EYXRhVVJMKCkpO1xufSk7XG5cblxuaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtb3VzZScpICE9PSBudWxsICYmIHdpbmRvdy5jb25maXJtKCfQktC+0YHRgdGC0LDQvdC+0LLQuNGC0Ywg0LTQsNC90L3Ri9C1INC/0YDQtdC00YvQtNGD0YnQtdC5INGB0LXRgdGB0LjQuD8nKSkge1xuICBjb25zdCB3aWR0aCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd3aWR0aCcpO1xuICBjb25zdCBkYXRhVVJMID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NhbnZhcycpO1xuICBjb25zdCBpbWdEYXRhID0gbmV3IEltYWdlKCk7XG4gIGltZ0RhdGEuc3JjID0gZGF0YVVSTDtcbiAgaW1nRGF0YS5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgY2FudmFzLmhlaWdodCA9IHdpZHRoO1xuICAgIGN0eC5kcmF3SW1hZ2UoaW1nRGF0YSwgMCwgMCk7XG4gIH07XG5cbiAgbW91c2UudG9vbCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdtb3VzZScpO1xuICBjaGFuZ2VDb2xvcihsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJldmlvdXNDb2xvcicpKTtcbiAgY2hhbmdlQ29sb3IobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRDb2xvcicpKTtcbiAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSBgdXJsKCcuL3NyYy9ibG9ja3MvbWFpbi8ke21vdXNlLnRvb2x9LnN2ZycpLCBhdXRvYDtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobW91c2UudG9vbCkucGFyZW50Tm9kZS5jbGFzc05hbWUgPSAnbGlzdF9faXRlbSBhY3RpdmUnO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFpbl9fY2FudmFzJykuc3R5bGUuaW1hZ2VSZW5kZXJpbmcgPSAncGl4ZWxhdGVkJztcbn1cblxud2luZG93Lm9udW5sb2FkID0gZnVuY3Rpb24gdW5sb2FkZXIoKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdtb3VzZScsIG1vdXNlLnRvb2wpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnY3VycmVudENvbG9yJywgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1cnJlbnQnKS5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJldmlvdXNDb2xvcicsIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2aW91cycpLnN0eWxlLmJhY2tncm91bmRDb2xvcik7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdpbnB1dC1yYW5nZScsIGlucHV0LnNpemUpO1xufTtcblxuXG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHttb3VzZS50b29sfWApLmNsaWNrKCk7XG5cbmNvbnN0IGxvZ2luID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lbnVfX2J1dHRvbicpO1xubG9naW4uaHJlZiA9ICdodHRwczovL2dpdGh1Yi5jb20vbG9naW4vb2F1dGgvYXV0aG9yaXplP2NsaWVudF9pZD1kMGZlMzk0YzQ2M2Q4ZTVlMDk3MyZyZWRpcmVjdF91cmk9aHR0cHM6Ly9hZ2VudHJhLmdpdGh1Yi5pby9pbWFnZS1hcGkvJztcbmxvZ2luLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IGxvZ2luLmhyZWY7XG59KTtcbiJdLCJzb3VyY2VSb290IjoiIn0=